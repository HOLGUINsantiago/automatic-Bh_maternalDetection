[2025-06-24 14:28:46,534] INFO [__main__.sequence_train:43] args: C:\Users\TeamGranon\anaconda3\envs\deg_solo\lib\site-packages\deepethogram\sequence\train.py project.path=D:\LBN\Maternal_auto_classification_train_deepethogram reload.weights=D:\LBN\Maternal_auto_classification_train_deepethogram\models\250616_145332_sequence_train\lightning_checkpoints\epoch=24-step=16349.ckpt
[2025-06-24 14:28:46,534] INFO [__main__.sequence_train:49] Configuration used: 
[2025-06-24 14:28:46,550] INFO [__main__.sequence_train:50] split:
  reload: true
  file: null
  train_val_test:
  - 0.9
  - 0.1
  - 0.0
compute:
  fp16: false
  num_workers: 3
  batch_size: 8
  min_batch_size: 8
  max_batch_size: 128
  distributed: false
  gpu_id: 0
  dali: false
  metrics_workers: 0
reload:
  overwrite_cfg: false
  latest: false
  weights: D:\LBN\Maternal_auto_classification_train_deepethogram\models\250616_145332_sequence_train\lightning_checkpoints\epoch=24-step=16349.ckpt
notes: null
log:
  level: info
feature_extractor:
  arch: resnet18
  fusion: average
  sampler: null
  final_bn: false
  sampling_ratio: null
  final_activation: sigmoid
  dropout_p: 0.25
  n_flows: 10
  n_rgb: 1
  curriculum: false
  inputs: both
  weights: pretrained
train:
  steps_per_epoch:
    train: 1000
    val: 1000
    test: 20
  num_epochs: 100
  lr: 0.0001
  scheduler: plateau
  min_lr: 5.0e-07
  stopping_type: learning_rate
  milestones:
  - 50
  - 100
  - 150
  - 200
  - 250
  - 300
  weight_loss: true
  patience: 5
  early_stopping_begins: 0
  viz_metrics: true
  viz_examples: 10
  reduction_factor: 0.1
  loss_weight_exp: 1.0
  loss_gamma: 1.0
  label_smoothing: 0.05
  oversampling_exp: 0.0
  regularization:
    style: l2
    alpha: 0.01
    beta: 0.001
sequence:
  arch: tgmj
  latent_name: resnet18
  output_name: null
  sequence_length: 180
  dropout_p: 0.5
  num_layers: 3
  hidden_size: 64
  nonoverlapping: true
  filter_length: 15
  input_dropout: 0.5
  n_filters: 8
  tgm_reduction: max
  c_in: 1
  c_out: 8
  soft_attn: true
  num_features: 128
  bidirectional: false
  rnn_style: lstm
  hidden_dropout: 0.0
  weights: null
  nonlinear_classification: true
  final_bn: true
  input_type: features
augs:
  LR: 0.5
  UD: 0.0
  brightness: 0.25
  contrast: 0.1
  crop_size: null
  degrees: 10
  grayscale: 0.5
  hue: 0.1
  normalization:
    'N': 694834329600
    mean:
    - 0.4213915600330549
    - 0.426960783932345
    - 0.365874038370559
    std:
    - 0.224414912593986
    - 0.2267886049471975
    - 0.22340896343317201
  pad: null
  random_resize: false
  resize:
  - 224
  - 224
  saturation: 0.1
cmap: deepethogram
control_arrow_jump: 31
label_view_width: 31
postprocessor:
  min_bout_length: 10
  type: min_bout_per_behavior
prediction_opacity: 0.2
project:
  class_names:
  - background
  - Onnest
  - Offnest
  - ABN
  - Carryingpups
  - Selfgrooming
  - Eat_drink
  - Kicking
  - Groomingpups
  - Build
  config_file: project_config.yaml
  data_path: D:\LBN\Maternal_auto_classification_train_deepethogram\DATA
  labeler: null
  model_path: D:\LBN\Maternal_auto_classification_train_deepethogram\models
  name: Maternal_auto_classification
  path: D:\LBN\Maternal_auto_classification_train_deepethogram
  pretrained_path: D:\LBN\Maternal_auto_classification_train_deepethogram\models\pretrained_models
run:
  type: train
  model: sequence
  dir: D:\LBN\Maternal_auto_classification_train_deepethogram\models\250624_142846_sequence_train
unlabeled_alpha: 0.1
vertical_arrow_jump: 3

[2025-06-24 14:28:46,985] WARNING [deepethogram.projects.filter_records_for_filetypes:663] No label file found in record: Cage8-CONT-2024-12-13_21-03-44
[2025-06-24 14:28:46,985] WARNING [deepethogram.projects.filter_records_for_filetypes:663] No label file found in record: Cage8-CONT-2024-12-15_04-13-47
[2025-06-24 14:28:46,985] WARNING [deepethogram.projects.filter_records_for_filetypes:663] No label file found in record: Cage8-CONT-2024-12-17_07-03-52
[2025-06-24 14:28:46,985] WARNING [deepethogram.projects.filter_records_for_filetypes:663] No label file found in record: Cage8-CONT-2024-12-17_23-07-19
[2025-06-24 14:28:46,985] WARNING [deepethogram.projects.filter_records_for_filetypes:663] No label file found in record: Cage8-CONT-2024-12-19_20-00-00
[2025-06-24 14:28:46,985] WARNING [deepethogram.projects.filter_records_for_filetypes:663] No label file found in record: Cage8-CONT-2024-12-19_20-10-00
[2025-06-24 14:28:47,000] WARNING [deepethogram.projects.filter_records_for_filetypes:663] No label file found in record: Cage8-CONT-2024-12-19_20-50-00
[2025-06-24 14:28:47,000] WARNING [deepethogram.projects.filter_records_for_filetypes:663] No label file found in record: Cage8-CONT-2024-12-19_21-00-00
[2025-06-24 14:28:47,000] WARNING [deepethogram.projects.filter_records_for_filetypes:663] No label file found in record: Cage8-CONT-2024-12-19_22-10-01
[2025-06-24 14:28:47,000] WARNING [deepethogram.projects.filter_records_for_filetypes:663] No label file found in record: Cage8-CONT-2024-12-19_22-30-01
[2025-06-24 14:28:47,000] WARNING [deepethogram.projects.filter_records_for_filetypes:663] No label file found in record: Cage8-CONT-2024-12-19_23-00-01
[2025-06-24 14:28:47,000] WARNING [deepethogram.projects.filter_records_for_filetypes:663] No label file found in record: Cage8-CONT-2024-12-20_02-10-06
[2025-06-24 14:29:20,098] INFO [deepethogram.data.utils.make_loss_weight:115] Class counts: [     0 718320 395909 254216  11967  79957 248962    525  36442  59764]
[2025-06-24 14:29:20,098] INFO [deepethogram.data.utils.make_loss_weight:116] Pos weight: [          inf    0.55044827    1.81306563    3.38099097   92.06576418
   12.92896182    3.47344575 2120.36761905   29.56138521   17.63526538]
[2025-06-24 14:29:20,098] INFO [deepethogram.data.utils.make_loss_weight:117] Pos weight, weighted: [   0.            0.55044824    1.8130656     3.380991     92.065765
   12.928962      3.4734457  2120.3677       29.561386     17.635265  ]
[2025-06-24 14:29:20,098] INFO [deepethogram.data.utils.make_loss_weight:118] Softmax weight: [0.         0.00067682 0.001228   0.00191245 0.04062629 0.00608045
 0.00195281 0.92604722 0.01334106 0.00813491]
[2025-06-24 14:29:20,098] INFO [deepethogram.data.utils.make_loss_weight:119] Softmax weight transformed: [0.         0.00067682 0.001228   0.00191245 0.04062629 0.00608045
 0.00195281 0.9260472  0.01334106 0.00813491]
[2025-06-24 14:29:22,843] WARNING [deepethogram.projects.get_weightfile_from_cfg:1090] no sequence weights found...
[2025-06-24 14:29:22,843] INFO [__main__.sequence_train:63] Total trainable params: 266,278
[2025-06-24 14:29:22,843] INFO [deepethogram.feature_extractor.train.get_metrics:632] key metric: f1_class_mean
[2025-06-24 14:29:22,861] INFO [deepethogram.feature_extractor.losses.__init__:100] Focal loss: gamma 1.00 smoothing: 0.05
[2025-06-24 14:29:22,862] INFO [deepethogram.losses.get_regularization_loss:188] Regularization: L2. alpha: 0.01 
[2025-06-24 14:29:22,863] INFO [deepethogram.base.__init__:95] scheduler mode: max
[2025-06-24 14:29:23,118] INFO [deepethogram.base.configure_optimizers:227] learning rate: 0.0001
[2025-06-24 16:11:42,111] INFO [deepethogram.callbacks.on_train_epoch_end:257] Stopping criterion reached! setting trainer.should_stop=True
